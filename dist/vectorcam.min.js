!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.vectorcam=e()}}(function(){var e;return function t(e,r,n){function i(a,s){if(!r[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[a]={exports:{}};e[a][0].call(d.exports,function(t){var r=e[a][1][t];return i(r?r:t)},d,d.exports,t,e,r,n)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,r){"use strict";function n(e){for(var t,r,i=Array.prototype.slice.call(arguments,1);i.length;){t=i.shift();for(r in t)t.hasOwnProperty(r)&&("object"==typeof e[r]&&e[r]&&"[object Array]"!==Object.prototype.toString.call(e[r])&&"object"==typeof t[r]&&null!==t[r]?e[r]=n(e[r],t[r]):e[r]=t[r])}return e}t.exports=n},{}],2:[function(e,t,r){function n(){d=!1,s.length?u=s.concat(u):l=-1,u.length&&i()}function i(){if(!d){var e=setTimeout(n);d=!0;for(var t=u.length;t;){for(s=u,u=[];++l<t;)s&&s[l].run();l=-1,t=u.length}s=null,d=!1,clearTimeout(e)}}function o(e,t){this.fun=e,this.array=t}function a(){}var s,c=t.exports={},u=[],d=!1,l=-1;c.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new o(e,t)),1!==u.length||d||setTimeout(i,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=a,c.addListener=a,c.once=a,c.off=a,c.removeListener=a,c.removeAllListeners=a,c.emit=a,c.binding=function(e){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(e){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},{}],3:[function(e,t,r){function n(e,t,r,n){return r=window.getComputedStyle,n=r?r(e):e.currentStyle,n?n[t.replace(/-(\w)/gi,function(e,t){return t.toUpperCase()})]:void 0}t.exports=n},{}],4:[function(t,r,n){!function(t,i,o,a){var s,c,u,d,l,f,m,g,h,p,v,b,w,y,C,S,x,k,F,E,A,O;s=function(){var e={URL:t.URL||t.webkitURL||t.mozURL||t.msURL,getUserMedia:function(){var e=o.getUserMedia||o.webkitGetUserMedia||o.mozGetUserMedia||o.msGetUserMedia;return e?e.bind(o):e}(),requestAnimFrame:t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame,requestTimeout:function(t,r){function n(){var e=(new Date).getTime(),s=e-i;s>=r?t.call():o.value=a(n)}if(t=t||e.noop,r=r||0,!e.requestAnimFrame)return setTimeout(t,r);var i=(new Date).getTime(),o=new Object,a=e.requestAnimFrame;return o.value=a(n),o},Blob:t.Blob||t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,btoa:function(){var e=t.btoa||function(e){for(var t,r,n,i,o,a,s,c="",u=0,d=e.length,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";d>u;)t=e.charCodeAt(u++),r=e.charCodeAt(u++),n=e.charCodeAt(u++),i=t>>2,o=(3&t)<<4|r>>4,a=(15&r)<<2|n>>6,s=63&n,isNaN(r)?a=s=64:isNaN(n)&&(s=64),c=c+l.charAt(i)+l.charAt(o)+l.charAt(a)+l.charAt(s);return c};return e?e.bind(t):function(){}}(),isObject:function(e){return e&&"[object Object]"===Object.prototype.toString.call(e)},isEmptyObject:function(t){return e.isObject(t)&&!Object.keys(t).length},isArray:function(e){return e&&Array.isArray(e)},isFunction:function(e){return e&&"function"==typeof e},isElement:function(e){return e&&1===e.nodeType},isString:function(e){return"string"==typeof e||"[object String]"===Object.prototype.toString.call(e)},isSupported:{canvas:function(){var e=i.createElement("canvas");return e&&e.getContext&&e.getContext("2d")},webworkers:function(){return t.Worker},blob:function(){return e.Blob},Uint8Array:function(){return t.Uint8Array},Uint32Array:function(){return t.Uint32Array},videoCodecs:function(){var e=i.createElement("video"),t={mp4:!1,h264:!1,ogv:!1,ogg:!1,webm:!1};try{e&&e.canPlayType&&(t.mp4=""!==e.canPlayType('video/mp4; codecs="mp4v.20.8"'),t.h264=""!==(e.canPlayType('video/mp4; codecs="avc1.42E01E"')||e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')),t.ogv=""!==e.canPlayType('video/ogg; codecs="theora"'),t.ogg=""!==e.canPlayType('video/ogg; codecs="theora"'),t.webm=-1!==e.canPlayType('video/webm; codecs="vp8, vorbis"'))}catch(r){}return t}()},noop:function(){},each:function(t,r){var n,i;if(e.isArray(t))for(n=-1,i=t.length;++n<i&&r(n,t[n])!==!1;);else if(e.isObject(t))for(n in t)if(t.hasOwnProperty(n)&&r(n,t[n])===!1)break},mergeOptions:function r(t,n){if(e.isObject(t)&&e.isObject(n)&&Object.keys){var i={};return e.each(t,function(e,r){i[e]=t[e]}),e.each(n,function(o,a){var s=n[o];e.isObject(s)&&t[o]?i[o]=r(t[o],s):i[o]=s}),i}},setCSSAttr:function(t,r,n){e.isElement(t)&&(e.isString(r)&&e.isString(n)?t.style[r]=n:e.isObject(r)&&e.each(r,function(e,r){t.style[e]=r}))},removeElement:function(t){e.isElement(t)&&t.parentNode&&t.parentNode.removeChild(t)},createWebWorker:function(t){if(!e.isString(t))return{};try{var r=new e.Blob([t],{type:"text/javascript"}),n=e.URL.createObjectURL(r),i=new Worker(n);return{objectUrl:n,worker:i}}catch(o){return""+o}},getExtension:function(e){return e.substr(e.lastIndexOf(".")+1,e.length)},getFontSize:function(e){if(e=e||{},!i.body||e.resizeFont===!1)return e.fontSize;var t=e.text,r=e.gifWidth,n=parseInt(e.fontSize,10),o=parseInt(e.minFontSize,10),a=i.createElement("div"),s=i.createElement("span");for(a.setAttribute("width",r),a.appendChild(s),s.innerHTML=t,s.style.fontSize=n+"px",s.style.textIndent="-9999px",s.style.visibility="hidden",i.body.appendChild(s);s.offsetWidth>r&&n>=o;)s.style.fontSize=--n+"px";return i.body.removeChild(s),n+"px"},webWorkerError:!1};return e}(),c=function(e){var t={validate:function(r){r=e.isObject(r)?r:{};var n={};return e.each(t.validators,function(e,t){var i=t.errorCode;return r[i]||t.condition?void 0:(n=t,n.error=!0,!1)}),delete n.condition,n},isValid:function(e){var r=t.validate(e),n=r.error!==!0?!0:!1;return n},validators:[{condition:e.isFunction(e.getUserMedia),errorCode:"getUserMedia",errorMsg:"The getUserMedia API is not supported in your browser"},{condition:e.isSupported.canvas(),errorCode:"canvas",errorMsg:"Canvas elements are not supported in your browser"},{condition:e.isSupported.webworkers(),errorCode:"webworkers",errorMsg:"The Web Workers API is not supported in your browser"},{condition:e.isFunction(e.URL),errorCode:"window.URL",errorMsg:"The window.URL API is not supported in your browser"},{condition:e.isSupported.blob(),errorCode:"window.Blob",errorMsg:"The window.Blob File API is not supported in your browser"},{condition:e.isSupported.Uint8Array(),errorCode:"window.Uint8Array",errorMsg:"The window.Uint8Array function constructor is not supported in your browser"},{condition:e.isSupported.Uint32Array(),errorCode:"window.Uint32Array",errorMsg:"The window.Uint32Array function constructor is not supported in your browser"}],messages:{videoCodecs:{errorCode:"videocodec",errorMsg:"The video codec you are trying to use is not supported in your browser"}}};return t}(s),u={sampleInterval:10,numWorkers:2,gifWidth:200,gifHeight:200,interval:.1,numFrames:10,keepCameraOn:!1,images:[],video:null,webcamVideoElement:null,cameraStream:null,text:"",fontWeight:"normal",fontSize:"16px",minFontSize:"10px",resizeFont:!1,fontFamily:"sans-serif",fontColor:"#ffffff",textAlign:"center",textBaseline:"bottom",textXCoordinate:null,textYCoordinate:null,progressCallback:function(e){},completeCallback:function(){},saveRenderingContexts:!1,savedRenderingContexts:[],crossOrigin:"Anonymous"},d=function(){return c.isValid()},l=function(){return c.isValid()},f=function(){var e={getUserMedia:!0};return c.isValid(e)},m=function(e){var t=!1;if(s.isArray(e)&&e.length){if(s.each(e,function(e,r){s.isSupported.videoCodecs[r]&&(t=!0)}),!t)return!1}else if(s.isString(e)&&e.length&&!s.isSupported.videoCodecs[e])return!1;return c.isValid({getUserMedia:!0})},g=function(){function e(){function e(e,t,r){var n,i;for(l=e,f=t,m=r,g=new Array(h),n=0;h>n;n++)g[n]=new Array(4),i=g[n],i[0]=i[1]=i[2]=(n<<S+8)/h|0,B[n]=F/h|0,q[n]=0}function t(){for(var e=[],t=new Array(h),r=0;h>r;r++)t[g[r][3]]=r;for(var n=0,i=0;h>i;i++){var o=t[i];e[n++]=g[o][0],e[n++]=g[o][1],e[n++]=g[o][2]}return e}function r(){var e,t,r,n,i,o,a,s;for(a=0,s=0,e=0;h>e;e++){for(i=g[e],r=e,n=i[1],t=e+1;h>t;t++)o=g[t],o[1]<n&&(r=t,n=o[1]);if(o=g[r],e!=r&&(t=o[0],o[0]=i[0],i[0]=t,t=o[1],o[1]=i[1],i[1]=t,t=o[2],o[2]=i[2],i[2]=t,t=o[3],o[3]=i[3],i[3]=t),n!=a){for(D[a]=s+e>>1,t=a+1;n>t;t++)D[t]=e;a=n,s=e}}for(D[a]=s+C>>1,t=a+1;256>t;t++)D[t]=C}function n(){var e,t,r,n,i,o,a,g,h,C,k,F,E,A;for(y>f&&(m=1),d=30+(m-1)/3,F=l,E=0,A=f,k=f/(3*m),C=k/x|0,g=V,o=T,a=o>>U,1>=a&&(a=0),e=0;a>e;e++)G[e]=g*((a*a-e*e)*z/(a*a));for(h=y>f?3:f%p!==0?3*p:f%v!==0?3*v:f%b!==0?3*b:3*w,e=0;k>e;)if(r=(255&F[E+0])<<S,n=(255&F[E+1])<<S,i=(255&F[E+2])<<S,t=u(r,n,i),c(g,t,r,n,i),0!==a&&s(a,t,r,n,i),E+=h,E>=A&&(E-=f),e++,0===C&&(C=1),e%C===0)for(g-=g/d,o-=o/I,a=o>>U,1>=a&&(a=0),t=0;a>t;t++)G[t]=g*((a*a-t*t)*z/(a*a))}function i(e,t,r){var n,i,o,a,s,c,u;for(s=1e3,u=-1,n=D[t],i=n-1;h>n||i>=0;)h>n&&(c=g[n],o=c[1]-t,o>=s?n=h:(n++,0>o&&(o=-o),a=c[0]-e,0>a&&(a=-a),o+=a,s>o&&(a=c[2]-r,0>a&&(a=-a),o+=a,s>o&&(s=o,u=c[3])))),i>=0&&(c=g[i],o=t-c[1],o>=s?i=-1:(i--,0>o&&(o=-o),a=c[0]-e,0>a&&(a=-a),o+=a,s>o&&(a=c[2]-r,0>a&&(a=-a),o+=a,s>o&&(s=o,u=c[3]))));return u}function o(){return n(),a(),r(),t()}function a(){var e;for(e=0;h>e;e++)g[e][0]>>=S,g[e][1]>>=S,g[e][2]>>=S,g[e][3]=e}function s(e,t,r,n,i){var o,a,s,c,u,d,l;for(s=t-e,-1>s&&(s=-1),c=t+e,c>h&&(c=h),o=t+1,a=t-1,d=1;c>o||a>s;){if(u=G[d++],c>o){l=g[o++];try{l[0]-=u*(l[0]-r)/P|0,l[1]-=u*(l[1]-n)/P|0,l[2]-=u*(l[2]-i)/P|0}catch(f){}}if(a>s){l=g[a--];try{l[0]-=u*(l[0]-r)/P|0,l[1]-=u*(l[1]-n)/P|0,l[2]-=u*(l[2]-i)/P|0}catch(f){}}}}function c(e,t,r,n,i){var o=g[t],a=e/V;o[0]-=a*(o[0]-r)|0,o[1]-=a*(o[1]-n)|0,o[2]-=a*(o[2]-i)|0}function u(e,t,r){var n,i,o,a,s,c,u,d,l,f;for(d=~(1<<31),l=d,c=-1,u=c,n=0;h>n;n++)f=g[n],i=f[0]-e,0>i&&(i=-i),o=f[1]-t,0>o&&(o=-o),i+=o,o=f[2]-r,0>o&&(o=-o),i+=o,d>i&&(d=i,c=n),a=i-(q[n]>>k-S),l>a&&(l=a,u=n),s=B[n]>>A,B[n]-=s,q[n]+=s<<E;return B[c]+=O,q[c]-=W,u}var d,l,f,m,g,h=256,p=499,v=491,b=487,w=503,y=3*w,C=h-1,S=4,x=100,k=16,F=1<<k,E=10,A=10,O=F>>A,W=F<<E-A,R=h>>3,U=6,M=1<<U,T=R*M,I=30,j=10,V=1<<j,L=8,z=1<<L,H=j+L,P=1<<H,D=[],q=[],B=[],G=[];e.apply(this,arguments);var N={};return N.map=i,N.process=o,N}return e}(),h=function(e){var t=function(){try{self.onmessage=function(e){var t,n=e.data||{};n.gifshot&&(t=r.run(n),postMessage(t))}}catch(t){}var r={dataToRGB:function(e,t,r){for(var n=0,i=t*r*4,o=[];i>n;)o.push(e[n++]),o.push(e[n++]),o.push(e[n++]),n++;return o},componentizedPaletteToArray:function(e){var t,r,n,i,o=[];for(t=0;t<e.length;t+=3)r=e[t],n=e[t+1],i=e[t+2],o.push(r<<16|n<<8|i);return o},processFrameWithQuantizer:function(t,r,n,i){var o,a,s,c,u=this.dataToRGB(t,r,n),d=new e(u,u.length,i),l=d.process(),f=new Uint32Array(this.componentizedPaletteToArray(l)),m=r*n,g=new Uint8Array(m),h=0;for(o=0;m>o;o++)a=u[h++],s=u[h++],c=u[h++],g[o]=d.map(a,s,c);return{pixels:g,palette:f}},run:function(e){var t=e.width,r=e.height,n=e.data,i=(e.palette,e.sampleInterval);return this.processFrameWithQuantizer(n,t,r,i)}};return r};return t}(g),p=function(e,t,r,n){function i(e){var t=e.length;if(2>t||t>256||t&t-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return t}function o(e,t,r,n){function i(r){for(;m>=r;)e[t++]=255&g,g>>=8,m-=8,t===s+256&&(e[s]=255,s=t++)}function o(e){g|=e<<m,m+=f,i(8)}e[t++]=r;var s=t++,c=1<<r,u=c-1,d=c+1,l=d+1,f=r+1,m=0,g=0,h=n[0]&u,p={};o(c);for(var v=1,b=n.length;b>v;++v){var w=n[v]&u,y=h<<8|w,C=p[y];if(C===a){for(g|=h<<m,m+=f;m>=8;)e[t++]=255&g,g>>=8,m-=8,t===s+256&&(e[s]=255,s=t++);4096===l?(o(c),l=d+1,f=r+1,p={}):(l>=1<<f&&++f,p[y]=l++),h=w}else h=C}return o(h),o(d),i(1),s+1===t?e[s]=0:(e[s]=t-s-1,e[t++]=0),t}var s=0;n=n===a?{}:n;var c=n.loop===a?null:n.loop,u=n.palette===a?null:n.palette;if(0>=t||0>=r||t>65535||r>65535)throw"Width/Height invalid.";e[s++]=71,e[s++]=73,e[s++]=70,e[s++]=56,e[s++]=57,e[s++]=97;var d=0,l=0;if(e[s++]=255&t,e[s++]=t>>8&255,e[s++]=255&r,e[s++]=r>>8&255,e[s++]=(null!==u?128:0)|d,e[s++]=l,e[s++]=0,null!==c){if(0>c||c>65535)throw"Loop count invalid.";e[s++]=33,e[s++]=255,e[s++]=11,e[s++]=78,e[s++]=69,e[s++]=84,e[s++]=83,e[s++]=67,e[s++]=65,e[s++]=80,e[s++]=69,e[s++]=50,e[s++]=46,e[s++]=48,e[s++]=3,e[s++]=1,e[s++]=255&c,e[s++]=c>>8&255,e[s++]=0}var f=!1;this.addFrame=function(t,r,n,c,d,l){if(f===!0&&(--s,f=!1),l=l===a?{}:l,0>t||0>r||t>65535||r>65535)throw"x/y invalid.";if(0>=n||0>=c||n>65535||c>65535)throw"Width/Height invalid.";if(d.length<n*c)throw"Not enough pixels for the frame size.";var m=!0,g=l.palette;if((g===a||null===g)&&(m=!1,g=u),g===a||null===g)throw"Must supply either a local or global palette.";for(var h=i(g),p=0;h>>=1;)++p;h=1<<p;var v=l.delay===a?0:l.delay,b=l.disposal===a?0:l.disposal;if(0>b||b>3)throw"Disposal out of range.";var w=!1,y=0;if(l.transparent!==a&&null!==l.transparent&&(w=!0,y=l.transparent,0>y||y>=h))throw"Transparent color index.";if((0!==b||w||0!==v)&&(e[s++]=33,e[s++]=249,e[s++]=4,e[s++]=b<<2|(w===!0?1:0),e[s++]=255&v,e[s++]=v>>8&255,e[s++]=y,e[s++]=0),e[s++]=44,e[s++]=255&t,e[s++]=t>>8&255,e[s++]=255&r,e[s++]=r>>8&255,e[s++]=255&n,e[s++]=n>>8&255,e[s++]=255&c,e[s++]=c>>8&255,e[s++]=m===!0?128|p-1:0,m===!0)for(var C=0,S=g.length;S>C;++C){var x=g[C];e[s++]=x>>16&255,e[s++]=x>>8&255,e[s++]=255&x}s=o(e,s,2>p?2:p,d)},this.end=function(){return f===!1&&(e[s++]=59,f=!0),s}},v=function(e,t,r,n){var o=function(t){this.canvas=null,this.ctx=null,this.repeat=0,this.frames=[],this.numRenderedFrames=0,this.onRenderCompleteCallback=e.noop,this.onRenderProgressCallback=e.noop,this.workers=[],this.availableWorkers=[],this.generatingGIF=!1,this.options=t,this.initializeWebWorkers(t)};return o.prototype={workerMethods:t(),initializeWebWorkers:function(n){var o,a,s,c,u=r.toString()+"("+t.toString()+"());",d=-1,l="";for(c=n.numWorkers;++d<c;)o=e.createWebWorker(u),e.isObject(o)?(a=o.objectUrl,s=o.worker,this.workers.push({worker:s,objectUrl:a}),this.availableWorkers.push(s)):(l=o,e.webWorkerError=!!o);this.workerError=l,this.canvas=i.createElement("canvas"),this.canvas.width=n.gifWidth,this.canvas.height=n.gifHeight,this.ctx=this.canvas.getContext("2d"),this.frames=[]},getWorker:function(){return this.availableWorkers.pop()},freeWorker:function(e){this.availableWorkers.push(e)},byteMap:function(){for(var e=[],t=0;256>t;t++)e[t]=String.fromCharCode(t);return e}(),bufferToString:function(e){for(var t=e.length,r="",n=-1;++n<t;)r+=this.byteMap[e[n]];return r},onFrameFinished:function(t){var r=this,n=r.frames,i=r.options;hasExistingImages=!!(i.images||[]).length,allDone=n.every(function(e){return!e.beingProcessed&&e.done}),r.numRenderedFrames++,hasExistingImages&&t(r.numRenderedFrames/n.length),r.onRenderProgressCallback(.75*r.numRenderedFrames/n.length),allDone?r.generatingGIF||r.generateGIF(n,r.onRenderCompleteCallback):e.requestTimeout(function(){r.processNextFrame()},1)},processFrame:function(e){var t,r,n=this,i=this.options,o=i.progressCallback,a=i.sampleInterval,s=this.frames,c=function(e){var i=e.data;delete t.data,t.pixels=Array.prototype.slice.call(i.pixels),t.palette=Array.prototype.slice.call(i.palette),t.done=!0,t.beingProcessed=!1,n.freeWorker(r),n.onFrameFinished(o)};return t=s[e],t.beingProcessed||t.done?void this.onFrameFinished():(t.sampleInterval=a,t.beingProcessed=!0,t.gifshot=!0,r=this.getWorker(),void(r?(r.onmessage=c,r.postMessage(t)):c({data:n.workerMethods.run(t)})))},startRendering:function(e){this.onRenderCompleteCallback=e;for(var t=0;t<this.options.numWorkers&&t<this.frames.length;t++)this.processFrame(t)},processNextFrame:function(){for(var e=-1,t=0;t<this.frames.length;t++){var r=this.frames[t];if(!r.done&&!r.beingProcessed){e=t;break}}e>=0&&this.processFrame(e)},generateGIF:function(t,r){var i,o,a=[],s={loop:this.repeat},c=this.options,u=c.interval,d=c.images,l=!!d.length,f=c.gifHeight,m=c.gifWidth,g=new n(a,m,f,s),h=this.onRenderProgressCallback,p=l?100*u:0;this.generatingGIF=!0,e.each(t,function(e,r){var n=r.palette;h(.75+.25*r.position*1/t.length),g.addFrame(0,0,m,f,r.pixels,{palette:n,delay:p})}),g.end(),h(1),this.frames=[],this.generatingGIF=!1,e.isFunction(r)&&(i=this.bufferToString(a),o="data:image/gif;base64,"+e.btoa(i),r(o))},setRepeat:function(e){this.repeat=e},addFrame:function(t,r){r=e.isObject(r)?r:{};var n,i=this,o=i.ctx,a=i.options,s=a.gifWidth,c=a.gifHeight,u=(r.gifHeight,r.gifWidth,r.text),d=r.fontWeight,l=e.getFontSize(r),f=r.fontFamily,m=r.fontColor,g=r.textAlign,h=r.textBaseline,p=r.textXCoordinate?r.textXCoordinate:"left"===g?1:"right"===g?s:s/2,v=r.textYCoordinate?r.textYCoordinate:"top"===h?1:"center"===h?c/2:c,b=d+" "+l+" "+f;try{o.drawImage(t,0,0,s,c),u&&(o.font=b,o.fillStyle=m,o.textAlign=g,o.textBaseline=h,o.fillText(u,p,v)),n=o.getImageData(0,0,s,c),i.addFrameImageData(n)}catch(w){return""+w}},addFrameImageData:function(e){var t=this.frames,r=e.data;this.frames.push({data:r,width:e.width,height:e.height,palette:null,dithering:null,done:!1,beingProcessed:!1,position:t.length})},onRenderProgress:function(e){this.onRenderProgressCallback=e},isRendering:function(){return this.generatingGIF},getBase64GIF:function(t){var r=this,n=function(n){r.destroyWorkers(),e.requestTimeout(function(){t(n)},0)};r.startRendering(n)},destroyWorkers:function(){if(!this.workerError){var t=this.workers;e.each(t,function(t,r){var n=r.worker,i=r.objectUrl;n.terminate(),e.URL.revokeObjectURL(i)})}}},o}(s,h,g,p),b=function(e,t){e.getBase64GIF(function(e){t({error:!1,errorCode:"",errorMsg:"",image:e})})},w=function(e){function t(){s.each(g,function(e,t){t&&n.addFrame(t,l)}),b(n,d)}var r,n,o=e.images,u=e.imagesLength,d=e.callback,l=e.options,f={getUserMedia:!0,"window.URL":!0},m=c.validate(f),g=[],h=0;return m.error?d(m):(n=new v(l),void s.each(o,function(e,n){s.isElement(n)?(l.crossOrigin&&(n.crossOrigin=l.crossOrigin),g[e]=n,h+=1,h===u&&t()):s.isString(n)&&(r=i.createElement("img"),l.crossOrigin&&(r.crossOrigin=l.crossOrigin),r.onerror=function(t){g.length>e&&(g[e]=a)}(function(r){r.onload=function(){g[e]=r,h+=1,h===u&&t(),s.removeElement(r)}}(r)),r.src=n,s.setCSSAttr(r,{position:"fixed",opacity:"0"}),i.body.appendChild(r))}))},y={getGIF:function(e,t){t=s.isFunction(t)?t:s.noop;var r,n=i.createElement("canvas"),o=e.images,a=!!o.length,c=e.videoElement,u=e.keepCameraOn,d=e.webcamVideoElement,l=e.cameraStream,f=+e.gifWidth,m=+e.gifHeight,g=e.videoWidth,h=e.videoHeight,p=(+e.sampleInterval,+e.numWorkers,e.crop),b=+e.interval,w=a?0:1e3*b,y=e.progressCallback,C=e.savedRenderingContexts,S=e.saveRenderingContexts,x=[],k=C.length?C.length:e.numFrames,F=k,E=new v(e),A=e.text,O=e.fontWeight,W=s.getFontSize(e),R=e.fontFamily,U=e.fontColor,M=e.textAlign,T=e.textBaseline,I=e.textXCoordinate?e.textXCoordinate:"left"===M?1:"right"===M?f:f/2,j=e.textYCoordinate?e.textYCoordinate:"top"===T?1:"center"===T?m/2:m,V=O+" "+W+" "+R,L=p?Math.floor(p.scaledWidth/2):0,z=p?g-p.scaledWidth:0,H=p?Math.floor(p.scaledHeight/2):0,P=p?h-p.scaledHeight:0,D=function q(){function e(){try{z>g&&(z=g),P>h&&(P=h),0>L&&(L=0),0>H&&(H=0),r.drawImage(c,L,H,z,P,0,0,f,m),n()}catch(t){if("NS_ERROR_NOT_AVAILABLE"!==t.name)throw t;s.requestTimeout(e,100)}}function n(){F=i;var n,o,a,g,h=k-F;S&&x.push(r.getImageData(0,0,f,m)),A&&(r.font=V,r.fillStyle=U,r.textAlign=M,r.textBaseline=T,r.fillText(A,I,j)),n=r.getImageData(0,0,f,m),o=n.data,a=o[0]+o[1]+o[2]+o[3],g=0===a,g?1===h&&1===k&&e():E.addFrameImageData(n),y(h/k),i>0&&s.requestTimeout(q,w),F||E.getBase64GIF(function(e){t({error:!1,errorCode:"",errorMsg:"",image:e,cameraStream:l,videoElement:c,webcamVideoElement:d,savedRenderingContexts:x,keepCameraOn:u})})}var i=F-1;C.length?(r.putImageData(C[k-F],0,0),n()):e()};k=null!=k?k:10,b=null!=b?b:.1,n.width=f,n.height=m,r=n.getContext("2d"),function B(){return C.length||0!==c.currentTime?void D():void s.requestTimeout(B,100)}()},getCropDimensions:function(e){var t=e.videoWidth,r=e.videoHeight,n=e.gifWidth,i=e.gifHeight,o={width:0,height:0,scaledWidth:0,scaledHeight:0};return t>r?(o.width=Math.round(t*(i/r))-n,o.scaledWidth=Math.round(o.width*(r/i))):(o.height=Math.round(r*(n/t))-i,o.scaledHeight=Math.round(o.height*(t/n))),o}},C={loadedData:!1,defaultVideoDimensions:{width:640,height:480},findVideoSize:function W(e){W.attempts=W.attempts||0;var t=this,r=e.videoElement,n=e.cameraStream,i=e.completedCallback;r&&(r.videoWidth>0&&r.videoHeight>0?(r.removeEventListener("loadeddata",t.findVideoSize),i({videoElement:r,cameraStream:n,videoWidth:r.videoWidth,videoHeight:r.videoHeight})):W.attempts<10?(W.attempts+=1,s.requestTimeout(function(){t.findVideoSize(e)},200)):i({videoElement:r,cameraStream:n,videoWidth:t.defaultVideoDimensions.width,videoHeight:t.defaultVideoDimensions.height}))},onStreamingTimeout:function(e){s.isFunction(e)&&e({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - Timed out while trying to start streaming",image:null,cameraStream:{}})},stream:function(e){var t=this,r=s.isArray(e.existingVideo)?e.existingVideo[0]:e.existingVideo,n=e.videoElement,i=e.cameraStream,o=e.streamedCallback,a=e.completedCallback;s.isFunction(o)&&o(),r?s.isString(r)&&(n.src=r,n.innerHTML='<source src="'+r+'" type="video/'+s.getExtension(r)+'" />'):n.mozSrcObject?n.mozSrcObject=i:s.URL&&(n.src=s.URL.createObjectURL(i)),n.play(),s.requestTimeout(function c(){c.count=c.count||0,t.loadedData===!0?(t.findVideoSize({videoElement:n,cameraStream:i,completedCallback:a}),t.loadedData=!1):(c.count+=1,c.count>10?t.findVideoSize({videoElement:n,cameraStream:i,completedCallback:a}):c())},100)},startStreaming:function(e){var t=this,r=s.isFunction(e.error)?e.error:s.noop,n=s.isFunction(e.streamed)?e.streamed:s.noop,o=s.isFunction(e.completed)?e.completed:s.noop,a=e.existingVideo,c=e.webcamVideoElement,u=s.isElement(a)?a:c?c:i.createElement("video"),d=e.lastCameraStream,l=e.crossOrigin,f=e.options;l&&(u.crossOrigin=f.crossOrigin),u.autoplay=!0,u.loop=!0,u.muted=!0,u.addEventListener("loadeddata",function(e){t.loadedData=!0}),a?t.stream({videoElement:u,existingVideo:a,completedCallback:o}):d?t.stream({videoElement:u,cameraStream:d,streamedCallback:n,completedCallback:o}):s.getUserMedia({video:!0},function(e){t.stream({videoElement:u,cameraStream:e,streamedCallback:n,completedCallback:o})},r)},startVideoStreaming:function(e,t){t=t||{};var r,n=this,i=t.timeout!==a?t.timeout:0,o=t.callback,c=t.webcamVideoElement;i>0&&(r=s.requestTimeout(function(){n.onStreamingTimeout(o)},1e4)),this.startStreaming({error:function(){o({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - the user probably denied permission",image:null,cameraStream:{}})},streamed:function(){clearTimeout(r)},completed:function(t){var r=t.cameraStream,n=t.videoElement,i=t.videoWidth,o=t.videoHeight;e({cameraStream:r,videoElement:n,videoWidth:i,videoHeight:o})},lastCameraStream:t.lastCameraStream,webcamVideoElement:c,crossOrigin:t.crossOrigin,options:t})},stopVideoStreaming:function(e){e=s.isObject(e)?e:{};var t=e.cameraStream,r=e.videoElement,n=e.keepCameraOn,i=e.webcamVideoElement;!n&&t&&s.isFunction(t.stop)&&t.stop(),s.isElement(r)&&!i&&(r.pause(),s.isFunction(s.URL.revokeObjectURL)&&!s.webWorkerError&&r.src&&s.URL.revokeObjectURL(r.src),s.removeElement(r))}},S=function(e){e=s.isObject(e)?e:{};var t=(s.isObject(e.options)?e.options:{},e.cameraStream),r=e.videoElement,n=e.webcamVideoElement,i=e.keepCameraOn;C.stopVideoStreaming({cameraStream:t,videoElement:r,keepCameraOn:i,webcamVideoElement:n})},x=function(e,t){var r=e.options||{},n=r.images,o=r.video,a=(+r.numFrames,e.cameraStream),c=e.videoElement,u=e.videoWidth,d=e.videoHeight,l=+r.gifWidth,f=+r.gifHeight,m=y.getCropDimensions({videoWidth:u,videoHeight:d,gifHeight:f,gifWidth:l}),g=t;r.crop=m,r.videoElement=c,r.videoWidth=u,r.videoHeight=d,r.cameraStream=a,s.isElement(c)&&(c.width=l+m.width,c.height=f+m.height,r.webcamVideoElement||(s.setCSSAttr(c,{position:"fixed",opacity:"0"}),i.body.appendChild(c)),c.play(),y.getGIF(r,function(e){n&&n.length||o&&o.length||S(e),g(e)}))},k=function(e){var t,r,n=e.existingVideo,i=e.callback,o=e.options,a={getUserMedia:!0,"window.URL":!0},u=c.validate(a);if(u.error)return i(u);if(s.isElement(n)&&n.src){if(r=n.src,t=s.getExtension(r),!s.isSupported.videoCodecs[t])return i(c.messages.videoCodecs)}else s.isArray(n)&&s.each(n,function(e,r){return t=r.substr(r.lastIndexOf(".")+1,r.length),s.isSupported.videoCodecs[t]?(n=r,!1):void 0});C.startStreaming({completed:function(e){e.options=o||{},x(e,i)},existingVideo:n,crossOrigin:o.crossOrigin,options:o})},F=function(e){var t=e.lastCameraStream,r=e.callback,n=e.webcamVideoElement,i=e.options;return l()?i.savedRenderingContexts.length?void y.getWebcamGIF(i,function(e){r(e)}):void C.startVideoStreaming(function(e){e.options=i||{},x(e,r)},{lastCameraStream:t,callback:r,webcamVideoElement:n,crossOrigin:i.crossOrigin}):r(c.validate())},E=function(e,t){if(t=s.isFunction(e)?e:t,e=s.isObject(e)?e:{},s.isFunction(t)){var r=s.mergeOptions(u,e)||{},n=e.cameraStream,i=r.images,o=i?i.length:0,a=r.video,c=r.webcamVideoElement;r=s.mergeOptions(r,{gifWidth:Math.floor(r.gifWidth),gifHeight:Math.floor(r.gifHeight)}),o?w({images:i,imagesLength:o,callback:t,options:r}):a?k({existingVideo:a,callback:t,options:r}):F({lastCameraStream:n,callback:t,webcamVideoElement:c,options:r})}},A=function(e,t){if(t=s.isFunction(e)?e:t,e=s.isObject(e)?e:{},s.isFunction(t)){var r=s.mergeOptions(u,e),n=s.mergeOptions(r,{interval:.1,numFrames:1,gifWidth:Math.floor(r.gifWidth),gifHeight:Math.floor(r.gifHeight)});E(n,t)}},O=function(e,t,r,n,i,o,a,s,c,u){var d={utils:e,error:t,defaultOptions:r,createGIF:s,takeSnapShot:c,stopVideoStreaming:u,isSupported:n,isWebCamGIFSupported:i,isExistingVideoGIFSupported:a,isExistingImagesGIFSupported:o,VERSION:"0.3.2"};return d}(s,c,u,d,l,f,m,E,A,S),function(i){"function"==typeof e&&e.amd?e([],function(){return i}):"undefined"!=typeof n?r.exports=i:t.gifshot=i}(O)}("undefined"!=typeof window?window:{},"undefined"!=typeof document?document:{createElement:function(){}},"undefined"!=typeof window?window.navigator:{})},{}],5:[function(e,t,r){for(var n=e("performance-now"),i="undefined"==typeof window?{}:window,o=["moz","webkit"],a="AnimationFrame",s=i["request"+a],c=i["cancel"+a]||i["cancelRequest"+a],u=0;u<o.length&&!s;u++)s=i[o[u]+"Request"+a],c=i[o[u]+"Cancel"+a]||i[o[u]+"CancelRequest"+a];if(!s||!c){var d=0,l=0,f=[],m=1e3/60;s=function(e){if(0===f.length){var t=n(),r=Math.max(0,m-(t-d));d=r+t,setTimeout(function(){var e=f.slice(0);f.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(d)}catch(r){setTimeout(function(){throw r},0)}},Math.round(r))}return f.push({handle:++l,callback:e,cancelled:!1}),l},c=function(e){for(var t=0;t<f.length;t++)f[t].handle===e&&(f[t].cancelled=!0)}}t.exports=function(e){return s.call(i,e)},t.exports.cancel=function(){c.apply(i,arguments)}},{"performance-now":6}],6:[function(e,t,r){(function(e){(function(){var r,n,i;"undefined"!=typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:"undefined"!=typeof e&&null!==e&&e.hrtime?(t.exports=function(){return(r()-i)/1e6},n=e.hrtime,r=function(){var e;return e=n(),1e9*e[0]+e[1]},i=r()):Date.now?(t.exports=function(){return Date.now()-i},i=Date.now()):(t.exports=function(){return(new Date).getTime()-i},i=(new Date).getTime())}).call(this)}).call(this,e("_process"))},{_process:2}],7:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(e){function t(e){e-g>h&&(g=e,r()),f&&u["default"](t)}function r(){var t=e.cloneNode(!0);document.body.appendChild(t),[].concat(i(t.querySelectorAll("*"))).forEach(function(e){o.forEach(function(t){return e.style[t]=l["default"](e,t)})});var r=(new XMLSerializer).serializeToString(t);p.add("data:image/svg+xml;utf8,"+r),document.body.removeChild(t)}var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=["background-color","color","dominant-baseline","fill","font-family","font-size","opacity","r","stroke","stroke-dasharray","stroke-width","text-anchor"],a={fps:4},c=s["default"]({},a,n),d=[],f=!1,g=-(1/0),h=1e3/c.fps,p=Object.defineProperties({start:function(){return p.reset(),f=!0,u["default"](t),p},stop:function(t){var r=e.getBoundingClientRect(),n=r.width,i=r.height;if(f=!1,d=d.map(function(e){return e.replace(/width="\d+"/,'width="'+n+'"').replace(/height="\d+"/,'height="'+i+'"')}),t){var o={images:d,gifWidth:n,gifHeight:i};return m["default"].createGIF(o,function(e){return t(e.error,e.image)}),p}},add:function(e){d.push(e)},snap:r,reset:function(){return d=[],p.pause(),p},pause:function(){return f=!1,p},resume:function(){return f=!0,p}},{frames:{get:function(){return[].concat(i(d))},configurable:!0,enumerable:!0},recording:{get:function(){return f},configurable:!0,enumerable:!0}});return p}Object.defineProperty(r,"__esModule",{value:!0});var a=e("assignment"),s=n(a),c=e("raf"),u=n(c),d=e("computed-style"),l=n(d),f=e("gifshot"),m=n(f);r["default"]=o,t.exports=r["default"]},{assignment:1,"computed-style":3,gifshot:4,raf:5}]},{},[7])(7)});